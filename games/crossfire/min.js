import e from"https://unpkg.com/kaboom@3000/dist/kaboom.mjs";function start(){go("menu")}e({width:128,height:256,background:[30,30,30],crisp:!0,scale:2.6}),randSeed(Date.now()),scene("menu",()=>{add([pos(width()/2,64),anchor("center"),text("Crossed Fire",{size:16})]),add([pos(width()/2,128),anchor("center"),text("click to start",{size:12})]),add([pos(width()-6,height()-8),anchor("right"),text("gabe 2024",{size:6})]),onKeyPress("space",()=>{go("game")}),onMousePress("left",()=>{go("game")})}),scene("game",()=>{let e=0,$=add([pos(width()/2,height()/2),text("0",{size:64}),anchor("center"),color(20,20,20),{anchor_y:height()/2}]);function i(i){e=i,$.text=e}$.onUpdate(()=>{$.pos.y=$.anchor_y+2*Math.sin(4*time())});let t=height();function o(){drawLine({p1:vec2(10,0),p2:vec2(10,t),width:2,color:MAGENTA}),drawLine({p1:vec2(width()-10,0),p2:vec2(width()-10,t),width:2,color:MAGENTA})}function s(){let e=add([pos(8,0),rect(24,32),color(30,30,30),outline(2,rgb(255,0,80)),area(),offscreen({destroy:!0}),{is_active:!1},"rockets","damage"]),$=add([pos(width()-32,0),color(30,30,30),rect(24,32),outline(2,rgb(255,0,80)),area(),offscreen({destroy:!0}),{is_active:!1},"rockets","damage"]);wait(1,()=>{e.is_active=!0,$.is_active=!0,shake(2)})}function a(){let e=choose([-1,1]),$=add([pos(10,rand(8,height()-8)),circle(6),color(255,0,80),"bullets",offscreen({destroy:!0}),{is_active:!1,dir:1,speed:120}]);$.add([color(30,30,30),circle(4),anchor("center"),area(),"damage"]);let i=rand(16,32),t=$.pos.y+i*e,o=add([pos(width()-10,t),circle(6),color(255,0,80),offscreen({destroy:!0}),"bullets",{is_active:!1,dir:-1,speed:120}]);o.add([color(30,30,30),circle(4),anchor("center"),area(),"damage"]),wait(1,()=>{$.is_active=!0,o.is_active=!0,shake(2)})}function c(){let e=add([pos(width()/2,-16),anchor("center"),color(255,0,80),circle(12),{anchor_y:height()/2,is_active:!1,counter:Math.PI},"disc"]);e.add([color(30,30,30),circle(10),anchor("center"),area(),"damage"]);tween(e.pos.y,height()/2,1,$=>{e.pos.y=$},easings.easeOutBack).onEnd(()=>{e.is_active=!0})}add([rect(10,t,{fill:!1}),body({isStatic:!0}),pos(0,0),area(),"wall"]),add([rect(10,t,{fill:!1}),body({isStatic:!0}),pos(width()-10,0),area(),"wall"]),onUpdate("rockets",e=>{e.is_active&&e.move(0,120)}),s(),onUpdate("bullets",e=>{e.is_active&&e.move(e.dir*e.speed,0)}),loop(3,a),onUpdate("disc",e=>{e.is_active&&(e.counter+=dt(),e.counter=e.counter%(2*Math.PI),e.pos.y=e.anchor_y+64*Math.sin(3*e.counter))}),c();let l=choose([-1,1]),n=!1,_=420,r=add([rect(10,10,{fill:!1}),outline(2,MAGENTA),pos(width()/2,height()/2),anchor("center"),rotate(0),area(),body({jumpForce:400}),{is_alive:!0}]);function d(){r.is_alive&&(n&&(l=-l,n=!1,_=420),r.jump())}r.onCollide("wall",$=>{r.is_alive&&(r.angle=0,n=!0,_=140,i(e+1))}),r.onCollide("damage",e=>{r.is_alive&&(r.is_alive=!1,r.collisionIgnore=["wall"],shake(8),r.vel.y=-300,wait(2,()=>{go("game")}))}),r.onUpdate(()=>{let e=dt();n||(r.angle+=360*e*l),r.vel.y+=1e3*e,r.vel.y=Math.min(r.vel.y,_),r.is_alive&&(r.pos.y>height()?r.moveTo(vec2(r.pos.x,0)):r.pos.y<0&&r.moveTo(vec2(r.pos.x,height()))),r.vel.x=120*l,r.move(r.vel)}),onKeyPress("space",()=>{d()}),onMousePress("left",()=>{d()}),onDraw(()=>{o()})}),start();